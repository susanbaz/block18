"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const chai_1 = require("chai");
require("mocha");
const __1 = require("..");
const context_1 = require("../../context");
const output_1 = require("../../output");
let context;
let out;
describe('Mixin', () => {
    beforeEach(() => {
        context = new context_1.Context;
        context.depth = 2;
        out = new output_1.OutputCollector;
    });
    it('should serialize to a module', () => {
        let rule = __1.mixin({
            name: __1.ident('myMixin'),
            value: __1.ruleset([
                __1.decl({ name: 'color', value: __1.anon('black') }),
                __1.decl({ name: 'background-color', value: __1.anon('white') })
            ])
        });
        rule.toModule(context, out);
        chai_1.expect(out.toString()).to.eq('let myMixin = function() { return $J.ruleset(\n  (() => {\n    const $OUT = []\n    $OUT.push($J.decl({\n      name: $J.anon("color"),\n      value: $J.anon("black")\n    }))\n    $OUT.push($J.decl({\n      name: $J.anon("background-color"),\n      value: $J.anon("white")\n    }))\n    return $OUT\n  })()\n)}');
        chai_1.expect(rule.value.obj()).to.deep.eq({
            "color": "black",
            "background-color": "white"
        });
    });
});
